{% include 'header.html' %}
{% include 'nav.html' %}

<div class="container">
    <div class="card my-4">
        <div class="card-body">
            <form id="post" action="{{ url_for('rt_add') }}" method="post">
                <h3>New transaction</h3>
                <hr>
                <div class="row">
                    <div class="col-md-6">
                        <h5>Credits</h5>
                        <button type="button" class="btn btn-primary btn-sm my-2" @click="addSrcAccount">Add credit
                        </button>
                        <button type="button" class="btn btn-danger btn-sm my-2" @click="transaction.src = []">Clear
                        </button>
                        <div v-for="tr in transaction.src">
                            <div class="form-group form-inline">
                                <input type="text" class="form-control" placeholder="Account name"
                                       v-model="tr.account" required>
                                <div class="input-group ml-2">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">$</div>
                                    </div>
                                    <input type="number" class="form-control" placeholder="Amount"
                                           v-model.number="tr.amount" min="0.01" step="0.01" required>
                                </div>
                                <button type="button" class="btn btn-danger ml-2" @click="delSrcAccount(tr)">
                                    <i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        <span class="badge badge-success">Total credits: $${Number.parseFloat(srcTotal).toFixed(2)}</span>
                    </div>
                    <div class="col-md-6">
                        <h5>Debits</h5>
                        <button type="button" class="btn btn-primary btn-sm my-2" @click="addDestAccount">Add debit
                        </button>
                        <button type="button" class="btn btn-danger btn-sm my-2" @click="transaction.dest = []">Clear
                        </button>
                        <div v-for="tr in transaction.dest">
                            <div class="form-group form-inline">
                                <input type="text" class="form-control" placeholder="Account name"
                                       v-model="tr.account" required>
                                <div class="input-group ml-2">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">$</div>
                                    </div>
                                    <input type="number" class="form-control" placeholder="Amount"
                                           v-model.number="tr.amount" min="0.01" step="0.01" required>
                                </div>
                                <button type="button" class="btn btn-danger ml-2" @click="delDestAccount(tr)">
                                    <i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                       <span class="badge badge-success">Total debits: $${Number.parseFloat(destTotal).toFixed(2)}</span>
                    </div>
                </div>
                <hr>
                <div class="form-group">
                    <label for="reason">Reason</label>
                    <input type="text" class="form-control" name="reason" placeholder="Transaction reason" required>
                </div>
                <p><span class="badge badge-danger" v-if="error">Invalid transaction: ${ error }</span></p>
                <button type="submit" class="btn btn-primary" :disabled="error !== ''">Submit</button>
            </form>
        </div>
    </div>
</div>
<script src="/static/ledger-post.js"></script>
{% include 'footer.html' %}